# 项目概览

## 📋 项目简介

这是一个为 macOS 设计的股票监控状态栏应用，主要功能是实时显示A股股票价格和涨跌情况。

## 🏗️ 架构设计

### 核心组件
- **应用入口** (`status_bar_app.py`) - 应用主程序
- **控制器** (`status_bar_controller.py`) - 业务逻辑控制
- **配置管理** (`config_manager.py`) - 配置文件管理
- **数据提供者** (`data_providers/`) - 数据获取模块
- **用户界面** (`ui/`) - 状态栏界面管理
- **工具类** (`utils/`) - 通用工具函数

### 设计模式
- **工厂模式** - 数据提供者创建
- **观察者模式** - 配置变更通知
- **单例模式** - 线程管理器
- **策略模式** - 不同数据源处理

## 🔧 配置系统

### 配置工具
- **统一入口** (`configure.py`) - 配置方式选择
- **快捷配置** (`tools/quick_config.py`) - 命令行配置
- **图形配置** (`tools/config_gui.py`) - 可视化配置
- **配置查看** (`tools/config.py`) - 配置内容查看

### 配置特性
- **热重载** - 配置修改自动生效
- **智能验证** - 输入格式自动检查
- **预设方案** - 常用配置快速选择
- **持久化** - 配置自动保存

## 📊 数据流程

```
股票API → 数据提供者 → 缓存层 → 格式化 → 状态栏显示
    ↓         ↓         ↓       ↓         ↓
  网络请求   数据解析   智能缓存  颜色处理   UI更新
```

### 数据特性
- **实时更新** - 定时获取最新数据
- **智能缓存** - 减少API请求次数
- **错误处理** - 网络异常自动重试
- **数据验证** - 确保数据完整性

## 🎨 颜色系统

### 颜色映射
```python
涨跌幅 > 0  → 🔴📈 (红色上涨)
涨跌幅 < 0  → 🟢📉 (绿色下跌)  
涨跌幅 = 0  → ⚪️➡️ (灰色平盘)
```

### 显示格式
- **完整显示** - `{colored_display}` 包含所有信息
- **自定义显示** - 支持多种字段组合
- **动态切换** - 可随时启用/禁用颜色

## 🔄 运行模式

### 显示模式
1. **单只股票** - 专注监控一只股票
2. **轮换显示** - 多只股票自动切换
3. **多只同显** - 同时显示多只股票

### 更新策略
- **定时更新** - 按配置间隔自动刷新
- **手动更新** - 通过菜单手动刷新
- **智能更新** - 交易时间内高频更新

## 🛠️ 开发指南

### 添加新功能
1. 在相应模块添加功能代码
2. 更新配置文件格式（如需要）
3. 添加配置界面选项（如需要）
4. 更新文档和测试

### 代码规范
- **类型注解** - 所有函数使用类型提示
- **错误处理** - 完善的异常处理机制
- **日志记录** - 关键操作记录日志
- **注释文档** - 清晰的代码注释

## 📦 依赖管理

### 核心依赖
- `rumps` - macOS状态栏应用框架
- `akshare` - 股票数据获取
- `pandas` - 数据处理
- `requests` - HTTP请求

### 可选依赖
- `tkinter` - 图形配置界面
- `threading` - 多线程支持

## 🔐 安全考虑

- **数据验证** - 所有输入数据验证
- **错误隔离** - 模块间错误不传播
- **资源管理** - 及时释放系统资源
- **权限最小** - 只请求必要权限 